# Pentest Interview questions

## **A definition of pentesting?**

* Pentesting is a security exercise where cybersecurity expert simulate activities as a attacker to identify the vulnerabilities in the system.
* Phases of a pentest
  * Passive Information Gathering
    * google, google hacking
    * Email harvesting
    * whois
    * recon-ng
  * Active Information Gathering
    * DNS enumeration
      * Finding subdomains
      * Zone trasfer
    * Port scaning
      * nmap
    * 
  * 

## **What are the types of Cross-site scripting?**

* XSS is a client-side code injection attack. The attacker aims to execute malicious scripts in a web browser of the victim by including malicious code in a web app caused by improperly sanitized user input.
* **Impacts:** session stealing, account takeover, Dom node replacement, malicious software downloads, key logging.
* **Reflected XSS:** The app or API includes unvalidated and unescaped user input as part of HTML output. Mostly redirect victim to other malicious site. Remediation
* **Stored XSS:** The app or API stores unsanitized user input that is viewed at a later time by another user or admin. High or critical risk.
* **DOM XSS:**  if the web app writes                 data to the Document Object Model without proper sanitization. Attacker can manipulate this data to include XSS content on the web page.
* **Remediation:** 
  * Filter input on arrival.
  * Encode data on output.
  * Use appropriate response headers. Content-Type and X-Content-Type-Options
  * Enabling a Content Security Policy(CSP)


## **Explain the difference between encoding and escaping**

* Encoding is transforming data from one format into another format. Replacing < with &lt;
* Escaping is a subset of encoding, where not all characters need to be encoded. Only some characters are encoded by using a escape character. "\"test\" 

## **What is the root cause of SQL injection? How do you fix it?**

* **Definition:** 
  * Type of a injection attack that makes it possible to execute malicious SQL statements which can control a database behind a web app. 
  * User-supplied data is not validated, filtered, or sanitized by the app.
* **Impacts:** 
  * Sensitive information extracted by attacker. Data breach. SQL commands can run operating system commands.
* **Remediation:** 
  * Use a safe API which avoids the use of the interpreter entirely or provides a parameterized interface.
  * Escape special characters using the specific escape syntax for that interpreter.

## **What is cross-site request forgery? What causes it? How do you fix it?**

* **Definition:** 
  * It is a vulnerability that allows an attacker to induce users to perform unwanted actions when the user is authenticated. 
* **Impacts:**
  * Transfer of funds, changing password, create new privileged users.
* **Remediation:**
  * Implement token based CSRF defense. Stateful for stateless.
  * For higly sensitive operations require re-authentication or one-time token.

## **XML External Entity XXE attack**

* **Definition:**
  * It is a type of attack against an application that parses XML input. It occurs when XML input containing a reference to an external entity is processed by a weakly configured XML parser.
* **Impacts:**
  * Disclosure of confidential data, denial of service, server side request forgery.
* **Remediation:**
  * Disable resolution of external entities and disable support for XInclude.
  

## **OSI layer model**

* **All people seems to need data process.**
  * Physical layer:
    * Cable, fiber
  * Data link layer: 
    * MAC
  * Network layer:
    * IP
  * Transport layer:
    * TCP UDP
  * Session layer:
    * Star or terminate a session
  * Presentation layer:
    * Translating between application and network formats. SSL TLS
  * Application layer:
    * What user can see.

## **AAA model**

* **Authentication**
  * Who you say you are. Identification required. 
    * Something you know PASSWD
    * Something you have KEY
    * Something you are FINGERPRINT
* **Authorization**
  * Providing correct level of access.
    * Least privilege.
* **Accounting**
  * Tracking of what users do while they are logged into a system.
    * From a forensics perspective, tracking back to events leading up to a cybersecurity incident can prove very valuable to an investigation.

## **Web app**

* **SQL**
  * Attacker interfere with the queries that an app makes to its database.
    * Attacker can view data that they are not normally able to retrieve. Or even cause a RCE.

  * **Blind SQL**
    * The database does not output data to the web page. 
    * Asking the database a series of true or false questions.
      * Triggering conditional responses
      * Triggering time delays
      * Using out-of-band techniques

## **Exploits**

* BOF
  * A program or process attempts to write more data to a fixed length block of memory.
    * Fuzzing is sending malformed data into app and watching for unexpected crashes.
    * Locate and controlling EIP 
      * Sending unique string to app to identify the 4 bytes of EIP
    * Check for Bad chars
    * Find the jump point when the time of the crash jump to ESP point execute the malicious code.